# æ’ä»¶ä»£ç æ¸…ç†åˆ†ææŠ¥å‘Š

**æ—¥æœŸ**: 2026-02-11
**åˆ†æèŒƒå›´**: å…¨é¡¹ç›®ä»£ç å®¡æŸ¥

---

## ğŸ“Š æ‰§è¡Œæ‘˜è¦

ç»è¿‡å…¨é¢åˆ†æï¼Œå‘ç°ä»¥ä¸‹é—®é¢˜ï¼š

| é—®é¢˜ç±»å‹ | æ•°é‡ | ä¸¥é‡ç¨‹åº¦ | é¢„è®¡æ¸…ç†ä»£ç é‡ |
|---------|------|---------|--------------|
| å®Œå…¨æœªä½¿ç”¨çš„æ–‡ä»¶ | 1 | ğŸ”´ é«˜ | ~100 è¡Œ |
| é‡å¤çš„äº¤æ˜“é€»è¾‘ | 3 æ–‡ä»¶ | ğŸ”´ é«˜ | ~1500 è¡Œ |
| å·²å¼ƒç”¨çš„å…¼å®¹å±‚ä»£ç  | 1 æ–‡ä»¶ | ğŸ”´ é«˜ | ~600 è¡Œ |
| é‡å¤çš„ç¼“å­˜ç³»ç»Ÿ | 2 å¥— | ğŸŸ¡ ä¸­ | ~300 è¡Œ |
| é‡å¤çš„é‡è¯•æœºåˆ¶ | 2 å¥— | ğŸŸ¡ ä¸­ | ~500 è¡Œ |
| é‡å¤çš„å®¢æˆ·ç«¯ç®¡ç† | 2 å¥— | ğŸŸ¡ ä¸­ | ~200 è¡Œ |
| **æ€»è®¡** | **10+** | - | **~3200 è¡Œ** |

---

## ğŸ”´ é«˜ä¼˜å…ˆçº§é—®é¢˜

### 1. å®Œå…¨æœªä½¿ç”¨çš„æ–‡ä»¶

#### `src/shared/pancake-sdk-utils.ts` (100 è¡Œ)

**é—®é¢˜**:
- å®šä¹‰äº† 4 ä¸ªå·¥å…·å‡½æ•°ï¼Œä½†**ä»æœªè¢«ä»»ä½•æ–‡ä»¶å¯¼å…¥æˆ–ä½¿ç”¨**
- è¿™äº›åŠŸèƒ½åº”è¯¥ç”± SDK æä¾›

**å‡½æ•°åˆ—è¡¨**:
```typescript
- calculateMinAmountOut()  // è®¡ç®—æ»‘ç‚¹åçš„æœ€å°è¾“å‡º
- calculatePriceImpact()   // è®¡ç®—ä»·æ ¼å½±å“
- formatSlippage()         // æ ¼å¼åŒ–æ»‘ç‚¹æ˜¾ç¤º
- formatPriceImpact()      // æ ¼å¼åŒ–ä»·æ ¼å½±å“æ˜¾ç¤º
```

**éªŒè¯**:
```bash
grep -r "pancake-sdk-utils" src/
# ç»“æœï¼šæ— ä»»ä½•å¯¼å…¥
```

**å»ºè®®**: âœ… **ç«‹å³åˆ é™¤æ­¤æ–‡ä»¶**

---

### 2. é‡å¤çš„äº¤æ˜“é€»è¾‘ï¼ˆbackground ç›®å½•ï¼‰

#### é—®é¢˜æ¦‚è¿°
åœ¨ `src/background/` ç›®å½•ä¸­ï¼Œå­˜åœ¨å¤šå¥—äº¤æ˜“å®ç°ç³»ç»Ÿå¹¶è¡Œè¿è¡Œï¼š

1. **four-quote-agent.ts** (7.5KB) - Four.meme æŠ¥ä»·ä»£ç†
2. **flap-quote-agent.ts** (2KB) - Flap æŠ¥ä»·ä»£ç†
3. **four-quote-bridge.ts** (30KB) - Four.meme æ¡¥æ¥å±‚
4. **sdk-trading.ts** (6KB) - SDK ç»Ÿä¸€äº¤æ˜“æ¥å£

**é‡å¤åˆ†æ**:

##### A. Four.meme äº¤æ˜“é€»è¾‘é‡å¤

**æ—§å®ç°** (`four-quote-agent.ts` + `four-quote-bridge.ts`):
- `four-quote-agent.ts`: å¤„ç† Four.meme æŠ¥ä»·è¯·æ±‚
- `four-quote-bridge.ts`:
  - `sendFourEncodedBuy()` - å‘é€ç¼–ç çš„ä¹°å…¥äº¤æ˜“
  - `executeFourQuoteBuy()` - æ‰§è¡ŒæŠ¥ä»·ä¹°å…¥
  - `buildFourSwapContext()` - æ„å»ºäº¤æ˜“ä¸Šä¸‹æ–‡
  - `assertWalletReadyForFourQuote()` - é’±åŒ…å‡†å¤‡æ£€æŸ¥
  - `encodeBuyTokenStruct()` - ç¼–ç ä¹°å…¥å‚æ•°

**æ–°å®ç°** (`sdk-trading.ts` + SDK):
- ä½¿ç”¨ `@bsc-trading/fourmeme` SDK
- ç»Ÿä¸€çš„ `executeBuy()` / `executeSell()` æ¥å£
- SDK å†…éƒ¨å¤„ç†æ‰€æœ‰ç¼–ç å’Œäº¤æ˜“é€»è¾‘

**é—®é¢˜**:
- ä¸¤å¥—ç³»ç»Ÿå¹¶å­˜ï¼Œé€ æˆä»£ç é‡å¤
- `four-quote-bridge.ts` 30KB ä»£ç å¤§éƒ¨åˆ†å¯ä»¥åˆ é™¤
- ç»´æŠ¤æˆæœ¬é«˜ï¼Œå®¹æ˜“å‡ºç°ä¸ä¸€è‡´

##### B. Flap äº¤æ˜“é€»è¾‘é‡å¤

**æ—§å®ç°** (`flap-quote-agent.ts`):
- å¤„ç† Flap æŠ¥ä»·è¯·æ±‚
- è‡ªå®šä¹‰çš„æŠ¥ä»·é€»è¾‘

**æ–°å®ç°** (`sdk-trading.ts` + SDK):
- ä½¿ç”¨ `@bsc-trading/flap` SDK
- ç»Ÿä¸€æ¥å£

**é—®é¢˜**:
- `flap-quote-agent.ts` å¯èƒ½å·²è¢« SDK æ›¿ä»£

##### C. ä½¿ç”¨æƒ…å†µåˆ†æ

**åœ¨ `background/index.ts` ä¸­çš„ä½¿ç”¨**:

1. **Four.meme ä¹°å…¥æµç¨‹** (ç¬¬ 2900-3000 è¡Œ):
```typescript
// ğŸ”´ é—®é¢˜ï¼šåŒæ—¶ä½¿ç”¨ä¸¤å¥—ç³»ç»Ÿ
if (useSDK) {
  // ä½¿ç”¨ SDK (sdk-trading.ts)
  result = await executeBuy(...);
} else {
  // ä½¿ç”¨æ—§ç³»ç»Ÿ (four-quote-bridge.ts)
  result = await sendFourEncodedBuy(...);
}
```

2. **Flap ä¹°å…¥æµç¨‹** (ç¬¬ 3100-3200 è¡Œ):
```typescript
// ğŸ”´ é—®é¢˜ï¼šåŒæ—¶ä½¿ç”¨ä¸¤å¥—ç³»ç»Ÿ
if (useSDK) {
  // ä½¿ç”¨ SDK
  result = await executeBuy(...);
} else {
  // ä½¿ç”¨æ—§ç³»ç»Ÿ (flap-quote-agent.ts)
  result = await executeFlapQuoteBuy(...);
}
```

**å»ºè®®**:
- âœ… **åˆ é™¤ `four-quote-bridge.ts` ä¸­çš„æ—§äº¤æ˜“å‡½æ•°**ï¼ˆä¿ç•™å¯èƒ½æœ‰ç”¨çš„å·¥å…·å‡½æ•°ï¼‰
- âœ… **åˆ é™¤ `flap-quote-agent.ts` ä¸­çš„æ—§äº¤æ˜“é€»è¾‘**
- âœ… **ç»Ÿä¸€ä½¿ç”¨ SDK äº¤æ˜“æ¥å£**
- âœ… **ç§»é™¤ `background/index.ts` ä¸­çš„ `useSDK` åˆ†æ”¯åˆ¤æ–­**

---

### 3. å·²å¼ƒç”¨çš„å…¼å®¹å±‚ä»£ç 

#### `src/shared/trading-channels-compat.ts` (600+ è¡Œå·²å¼ƒç”¨ä»£ç )

**é—®é¢˜**: åŒ…å«å¤§é‡æ ‡è®°ä¸º `@deprecated` çš„å‡½æ•°ï¼Œä½†ä»å ç”¨ä»£ç ç©ºé—´

##### A. æˆæƒç¼“å­˜ç›¸å…³ (ç¬¬ 299-345 è¡Œ)

```typescript
// ğŸ”´ é—®é¢˜ï¼šè¿™äº›å‡½æ•°ä»æœªè¢«ä½¿ç”¨
export function getCachedAllowance() {
  return undefined; // ç›´æ¥è¿”å› undefinedï¼Œæ— å®é™…åŠŸèƒ½
}

export function clearAllowanceCache() {
  // ç»´æŠ¤ä¸€ä¸ªä»æœªè¢«ä½¿ç”¨çš„ allowanceCache Map
}
```

**éªŒè¯**:
```bash
grep -r "getCachedAllowance\|clearAllowanceCache" src/
# ç»“æœï¼šåªæœ‰å®šä¹‰ï¼Œæ— è°ƒç”¨
```

**å»ºè®®**: âœ… **ç«‹å³åˆ é™¤**ï¼ˆçº¦ 50 è¡Œï¼‰

##### B. Pancake åå¥½æ¨¡å¼ (ç¬¬ 252-275 è¡Œ)

```typescript
// ğŸ”´ é—®é¢˜ï¼šæ—§çš„ v2/v3 é€‰æ‹©æœºåˆ¶ï¼Œå·²è¢« SDK æ›¿ä»£
export function setPancakePreferredMode() { ... }
export function getPancakePreferredMode() { ... }
```

**éªŒè¯**:
```bash
grep -r "getPancakePreferredMode" src/
# ç»“æœï¼šåªæœ‰å®šä¹‰ï¼Œæ— è°ƒç”¨
```

**å»ºè®®**: âœ… **åˆ é™¤**ï¼ˆçº¦ 25 è¡Œï¼‰

##### C. ä»£å¸äº¤æ˜“æç¤ºç¼“å­˜ (ç¬¬ 278-296 è¡Œ)

```typescript
// ğŸŸ¡ é—®é¢˜ï¼šä»…åœ¨ content/index.ts ä¸­ä½¿ç”¨ï¼Œä½†å¯ä»¥ç”¨ route-query æ›¿ä»£
export function setTokenTradeHint() { ... }
export function getTokenTradeHint() { ... }
```

**ä½¿ç”¨ä½ç½®**: `src/content/index.ts` ç¬¬ 4023-4040 è¡Œ

**å»ºè®®**: ğŸŸ¡ **è¿ç§»åˆ° route-query æ¨¡å—ååˆ é™¤**ï¼ˆçº¦ 20 è¡Œï¼‰

##### D. è·¯ç”±ç¼“å­˜æ£€æŸ¥ (ç¬¬ 513-568 è¡Œ)

```typescript
// ğŸŸ¡ é—®é¢˜ï¼šå·²è¢« route-query/route-cache-manager.ts æ›¿ä»£
export function checkRouteCache() { ... }
export function isRouteCacheExpiringSoon() { ... }
```

**ä½¿ç”¨ä½ç½®**: `src/content/index.ts` ç¬¬ 4023-4049 è¡Œ

**å»ºè®®**: ğŸŸ¡ **è¿ç§»åˆ° route-query æ¨¡å—ååˆ é™¤**ï¼ˆçº¦ 60 è¡Œï¼‰

##### E. prepareTokenSell() (ç¬¬ 389-495 è¡Œ)

```typescript
// ğŸ”´ é—®é¢˜ï¼šå·²è¢« SDK çš„å–å‡ºæµç¨‹æ›¿ä»£
export async function prepareTokenSell() { ... }
```

**éªŒè¯**:
```bash
grep -r "prepareTokenSell" src/
# ç»“æœï¼šåªæœ‰å®šä¹‰ï¼Œæ— è°ƒç”¨
```

**å»ºè®®**: âœ… **ç«‹å³åˆ é™¤**ï¼ˆçº¦ 110 è¡Œï¼‰

**æ€»è®¡**: å¯åˆ é™¤çº¦ **265 è¡Œ**å·²å¼ƒç”¨ä»£ç 

---

## ğŸŸ¡ ä¸­ä¼˜å…ˆçº§é—®é¢˜

### 4. é‡å¤çš„ç¼“å­˜ç³»ç»Ÿ

#### é—®é¢˜æ¦‚è¿°
é¡¹ç›®ä¸­å­˜åœ¨ **5 å¥—ç¼“å­˜ç³»ç»Ÿ**ï¼Œä½†åªæœ‰ 1 å¥—è¢«çœŸæ­£ä½¿ç”¨ï¼š

| ç¼“å­˜ç³»ç»Ÿ | æ–‡ä»¶ | å¤§å° | ä½¿ç”¨æƒ…å†µ |
|---------|------|------|---------|
| CacheManager | `cache-manager.ts` | 7.5KB | âŒ æœªä½¿ç”¨ |
| LRUCache | `lru-cache.ts` | 7.9KB | âœ… è¢« route-query ä½¿ç”¨ |
| RouteCacheManager | `route-query/route-cache-manager.ts` | - | âœ… ä½¿ç”¨ä¸­ |
| CacheMonitor | `cache-monitor.ts` | 11KB | âœ… è¢« route-query ä½¿ç”¨ |
| CacheWarmer | `cache-warmup.ts` | 9KB | âŒ æœªä½¿ç”¨ |

##### A. CacheManager (æœªä½¿ç”¨)

**é—®é¢˜**:
- é€šç”¨ç¼“å­˜ç®¡ç†å™¨ï¼Œæ”¯æŒ TTLã€ä½œç”¨åŸŸã€LRU
- ä½†**ä»æœªè¢«ä»»ä½•ä»£ç ä½¿ç”¨**

**éªŒè¯**:
```bash
grep -r "from.*cache-manager" src/
# ç»“æœï¼šæ— å¯¼å…¥
```

**å»ºè®®**: ğŸŸ¡ **è€ƒè™‘åˆ é™¤æˆ–æ•´åˆåˆ° route-query ç³»ç»Ÿ**ï¼ˆçº¦ 200 è¡Œï¼‰

##### B. CacheWarmer (æœªä½¿ç”¨)

**é—®é¢˜**:
- ç¼“å­˜é¢„çƒ­ç³»ç»Ÿ
- ä½†**ä»æœªè¢«è°ƒç”¨**

**éªŒè¯**:
```bash
grep -r "CacheWarmer\|createCacheWarmer" src/
# ç»“æœï¼šåªæœ‰å®šä¹‰ï¼Œæ— ä½¿ç”¨
```

**å»ºè®®**: ğŸŸ¡ **åˆ é™¤æˆ–æ•´åˆ**ï¼ˆçº¦ 150 è¡Œï¼‰

---

### 5. é‡å¤çš„é‡è¯•æœºåˆ¶

#### ä¸¤å¥—é‡è¯•ç³»ç»Ÿå¹¶å­˜

| ç³»ç»Ÿ | æ–‡ä»¶ | å¤§å° | ä½¿ç”¨ä½ç½® |
|------|------|------|---------|
| retry-helper | `retry-helper.ts` | 5KB | `background/index.ts` |
| retry | `retry.ts` | 10.8KB | `route-query/query-executor.ts` |

##### A. retry-helper.ts (ç®€æ´ç‰ˆ)

**åŠŸèƒ½**:
- `retry()` - é€šç”¨é‡è¯•å‡½æ•°
- `isRpcError()` - RPC é”™è¯¯æ£€æµ‹
- `createRetry()` - åˆ›å»ºé‡è¯•å‡½æ•°

**ç‰¹ç‚¹**: ç®€æ´ã€æ˜“ç”¨

##### B. retry.ts (å¤æ‚ç‰ˆ)

**åŠŸèƒ½**:
- `withRetry()` - å¸¦é‡è¯•çš„å¼‚æ­¥æ‰§è¡Œ
- `withFastRetry()` / `withStandardRetry()` / `withAggressiveRetry()` ç­‰é¢„è®¾
- `RetryStatsCollector` - é‡è¯•ç»Ÿè®¡
- æ›´å¤šé…ç½®é€‰é¡¹

**ç‰¹ç‚¹**: åŠŸèƒ½ä¸°å¯Œï¼Œä½†å¤æ‚

**é—®é¢˜**:
- ä¸¤å¥—ç³»ç»ŸåŠŸèƒ½é‡å  80%
- ä»£ç é‡å¤ï¼Œç»´æŠ¤æˆæœ¬é«˜
- åº”è¯¥ç»Ÿä¸€ä½¿ç”¨ä¸€å¥—

**å»ºè®®**: ğŸŸ¡ **ç»Ÿä¸€ä½¿ç”¨ `retry-helper.ts`**ï¼ˆæ›´ç®€æ´ï¼‰ï¼Œå°† `retry.ts` ä¸­çš„ç‰¹æ®ŠåŠŸèƒ½è¿ç§»è¿‡æ¥ï¼Œç„¶ååˆ é™¤ `retry.ts`ï¼ˆçº¦ 500 è¡Œï¼‰

---

### 6. é‡å¤çš„å®¢æˆ·ç«¯ç®¡ç†

#### ä¸¤å¥— Viem å®¢æˆ·ç«¯ç®¡ç†ç³»ç»Ÿ

##### A. SDKClientManager (`sdk-client-manager.ts`)

**åŠŸèƒ½**:
- åˆ›å»ºå’Œç®¡ç† `publicClient`, `walletClient`
- ç»Ÿä¸€çš„å®¢æˆ·ç«¯æ¥å£
- æ”¯æŒå®¢æˆ·ç«¯é‡ç”¨

**ä½ç½®**: `src/shared/sdk-client-manager.ts`

##### B. background/index.ts ä¸­çš„å…¨å±€å®¢æˆ·ç«¯

**åŠŸèƒ½**:
- ç»´æŠ¤å…¨å±€å˜é‡ `publicClient`, `walletClient`, `walletAccount`
- åœ¨ `initializeWallet()` ä¸­åˆå§‹åŒ–
- åœ¨å„ä¸ªäº¤æ˜“å‡½æ•°ä¸­ä½¿ç”¨

**ä½ç½®**: `src/background/index.ts` ç¬¬ 80-100 è¡Œ

**é—®é¢˜**:
- ä¸¤å¥—ç³»ç»Ÿå¹¶è¡Œè¿è¡Œ
- `background/index.ts` ç¬¬ 80 è¡Œå¯¼å…¥ `sdkClientManager`ï¼Œä½†åŒæ—¶ç»´æŠ¤è‡ªå·±çš„å®¢æˆ·ç«¯
- é€ æˆèµ„æºæµªè´¹å’ŒçŠ¶æ€ä¸ä¸€è‡´é£é™©

**å»ºè®®**: ğŸŸ¡ **ç»Ÿä¸€ä½¿ç”¨ `SDKClientManager`**ï¼Œç§»é™¤ `background/index.ts` ä¸­çš„é‡å¤å®¢æˆ·ç«¯ç®¡ç†ä»£ç ï¼ˆçº¦ 100 è¡Œï¼‰

---

### 7. viem-helper.ts å¯ä»¥æ•´åˆ

#### `src/shared/viem-helper.ts` (2.5KB)

**åŠŸèƒ½**:
- `buildChainConfig()` - ç¼“å­˜ chain config
- `createHttpClient()` / `createWebSocketClient()` - åˆ›å»ºå®¢æˆ·ç«¯
- `createWallet()` - åˆ›å»ºé’±åŒ…

**ä½¿ç”¨ä½ç½®**: `background/index.ts`

**é—®é¢˜**:
- è¿™äº›åŠŸèƒ½åº”è¯¥ç”± `SDKClientManager` æä¾›
- é€ æˆå®¢æˆ·ç«¯åˆ›å»ºé€»è¾‘åˆ†æ•£

**å»ºè®®**: ğŸŸ¡ **è¿ç§»åˆ° `SDKClientManager`**ï¼Œç„¶ååˆ é™¤ `viem-helper.ts`ï¼ˆçº¦ 100 è¡Œï¼‰

---

## ğŸ“‹ æ¸…ç†è®¡åˆ’

### é˜¶æ®µ 1: ç«‹å³æ¸…ç†ï¼ˆé«˜ä¼˜å…ˆçº§ï¼‰

**é¢„è®¡æ¸…ç†ä»£ç **: ~1865 è¡Œ

| ä»»åŠ¡ | æ–‡ä»¶ | è¡Œæ•° | éš¾åº¦ |
|------|------|------|------|
| 1. åˆ é™¤æœªä½¿ç”¨çš„å·¥å…·æ–‡ä»¶ | `pancake-sdk-utils.ts` | ~100 | â­ ç®€å• |
| 2. åˆ é™¤æœªä½¿ç”¨çš„å…¼å®¹å±‚å‡½æ•° | `trading-channels-compat.ts` | ~265 | â­ ç®€å• |
| 3. æ¸…ç† Four.meme æ—§äº¤æ˜“é€»è¾‘ | `four-quote-bridge.ts` | ~1000 | â­â­ ä¸­ç­‰ |
| 4. æ¸…ç† Flap æ—§äº¤æ˜“é€»è¾‘ | `flap-quote-agent.ts` | ~100 | â­â­ ä¸­ç­‰ |
| 5. ç§»é™¤ background ä¸­çš„åˆ†æ”¯åˆ¤æ–­ | `background/index.ts` | ~400 | â­â­â­ å¤æ‚ |

**è¯¦ç»†æ­¥éª¤**:

#### 1.1 åˆ é™¤ pancake-sdk-utils.ts
```bash
rm src/shared/pancake-sdk-utils.ts
```

#### 1.2 åˆ é™¤ trading-channels-compat.ts ä¸­çš„æœªä½¿ç”¨å‡½æ•°
åˆ é™¤ä»¥ä¸‹å‡½æ•°ï¼š
- `getCachedAllowance()` (ç¬¬ 314-317 è¡Œ)
- `clearAllowanceCache()` (ç¬¬ 323-345 è¡Œ)
- `setPancakePreferredMode()` (ç¬¬ 260-267 è¡Œ)
- `getPancakePreferredMode()` (ç¬¬ 273-275 è¡Œ)
- `prepareTokenSell()` (ç¬¬ 389-495 è¡Œ)

#### 1.3 æ¸…ç† four-quote-bridge.ts
ä¿ç•™ï¼š
- å¯èƒ½æœ‰ç”¨çš„å·¥å…·å‡½æ•°
- é”™è¯¯å¤„ç†é€»è¾‘

åˆ é™¤ï¼š
- `sendFourEncodedBuy()` - å·²è¢« SDK æ›¿ä»£
- `executeFourQuoteBuy()` - å·²è¢« SDK æ›¿ä»£
- `buildFourSwapContext()` - å·²è¢« SDK æ›¿ä»£
- `assertWalletReadyForFourQuote()` - å·²è¢« SDK æ›¿ä»£
- `encodeBuyTokenStruct()` - å·²è¢« SDK æ›¿ä»£

#### 1.4 æ¸…ç† flap-quote-agent.ts
- åˆ é™¤æ—§çš„æŠ¥ä»·é€»è¾‘
- ä¿ç•™å¯èƒ½æœ‰ç”¨çš„é”™è¯¯å¤„ç†

#### 1.5 ç§»é™¤ background/index.ts ä¸­çš„åˆ†æ”¯åˆ¤æ–­
å°†æ‰€æœ‰ `if (useSDK) { ... } else { ... }` æ”¹ä¸ºåªä½¿ç”¨ SDK åˆ†æ”¯

---

### é˜¶æ®µ 2: çŸ­æœŸæ¸…ç†ï¼ˆä¸­ä¼˜å…ˆçº§ï¼‰

**é¢„è®¡æ¸…ç†ä»£ç **: ~1050 è¡Œ

| ä»»åŠ¡ | æ–‡ä»¶ | è¡Œæ•° | éš¾åº¦ |
|------|------|------|------|
| 6. ç»Ÿä¸€é‡è¯•æœºåˆ¶ | `retry.ts` | ~500 | â­â­ ä¸­ç­‰ |
| 7. ç»Ÿä¸€å®¢æˆ·ç«¯ç®¡ç† | `background/index.ts` | ~100 | â­â­â­ å¤æ‚ |
| 8. åˆ é™¤æœªä½¿ç”¨çš„ç¼“å­˜ç³»ç»Ÿ | `cache-manager.ts`, `cache-warmup.ts` | ~350 | â­â­ ä¸­ç­‰ |
| 9. æ•´åˆ viem-helper | `viem-helper.ts` | ~100 | â­â­ ä¸­ç­‰ |

---

### é˜¶æ®µ 3: é•¿æœŸæ¸…ç†ï¼ˆä½ä¼˜å…ˆçº§ï¼‰

**é¢„è®¡æ¸…ç†ä»£ç **: ~285 è¡Œ

| ä»»åŠ¡ | æ–‡ä»¶ | è¡Œæ•° | éš¾åº¦ |
|------|------|------|------|
| 10. è¿ç§» content ä¸­çš„ç¼“å­˜æ£€æŸ¥ | `content/index.ts` | ~30 | â­â­ ä¸­ç­‰ |
| 11. åˆ é™¤ trading-channels-compat ä¸­çš„ç¼“å­˜å‡½æ•° | `trading-channels-compat.ts` | ~80 | â­ ç®€å• |
| 12. å®Œå…¨ç§»é™¤å…¼å®¹å±‚ | `trading-channels-compat.ts` | ~175 | â­â­â­ å¤æ‚ |

---

## ğŸ“Š é¢„æœŸæ”¶ç›Š

### ä»£ç é‡å‡å°‘
- **é˜¶æ®µ 1**: å‡å°‘ ~1865 è¡Œï¼ˆçº¦ 13%ï¼‰
- **é˜¶æ®µ 2**: å‡å°‘ ~1050 è¡Œï¼ˆçº¦ 7%ï¼‰
- **é˜¶æ®µ 3**: å‡å°‘ ~285 è¡Œï¼ˆçº¦ 2%ï¼‰
- **æ€»è®¡**: å‡å°‘ ~3200 è¡Œï¼ˆçº¦ 22%ï¼‰

### ä»£ç è´¨é‡æå‡
- âœ… æ¶ˆé™¤é‡å¤é€»è¾‘
- âœ… ç»Ÿä¸€äº¤æ˜“æ¥å£
- âœ… ç®€åŒ–ç»´æŠ¤æˆæœ¬
- âœ… æé«˜ä»£ç å¯è¯»æ€§
- âœ… å‡å°‘æ½œåœ¨ bug

### æ€§èƒ½æå‡
- âœ… å‡å°‘å†…å­˜å ç”¨ï¼ˆåˆ é™¤æœªä½¿ç”¨çš„ç¼“å­˜ç³»ç»Ÿï¼‰
- âœ… å‡å°‘å®¢æˆ·ç«¯é‡å¤åˆ›å»º
- âœ… ç»Ÿä¸€é‡è¯•æœºåˆ¶ï¼Œå‡å°‘é‡å¤é€»è¾‘

---

## âš ï¸ é£é™©è¯„ä¼°

### é«˜é£é™©æ“ä½œ
1. **åˆ é™¤ four-quote-bridge.ts ä¸­çš„å‡½æ•°**
   - é£é™©: å¯èƒ½æœ‰éšè—çš„ä¾èµ–
   - ç¼“è§£: å…ˆæœç´¢æ‰€æœ‰è°ƒç”¨ï¼Œç¡®è®¤æ— ä¾èµ–åå†åˆ é™¤

2. **ç§»é™¤ background/index.ts ä¸­çš„åˆ†æ”¯åˆ¤æ–­**
   - é£é™©: å¯èƒ½å½±å“ç°æœ‰äº¤æ˜“æµç¨‹
   - ç¼“è§£: å……åˆ†æµ‹è¯•æ‰€æœ‰äº¤æ˜“åœºæ™¯

### ä¸­é£é™©æ“ä½œ
3. **ç»Ÿä¸€å®¢æˆ·ç«¯ç®¡ç†**
   - é£é™©: å¯èƒ½å½±å“å®¢æˆ·ç«¯åˆå§‹åŒ–æµç¨‹
   - ç¼“è§£: é€æ­¥è¿ç§»ï¼Œä¿æŒå‘åå…¼å®¹

4. **ç»Ÿä¸€é‡è¯•æœºåˆ¶**
   - é£é™©: å¯èƒ½å½±å“é”™è¯¯å¤„ç†é€»è¾‘
   - ç¼“è§£: ä¿ç•™æ‰€æœ‰é”™è¯¯å¤„ç†åŠŸèƒ½

### ä½é£é™©æ“ä½œ
5. **åˆ é™¤æœªä½¿ç”¨çš„æ–‡ä»¶å’Œå‡½æ•°**
   - é£é™©: ä½ï¼ˆå·²éªŒè¯æ— è°ƒç”¨ï¼‰
   - ç¼“è§£: ä½¿ç”¨ git å¯ä»¥éšæ—¶æ¢å¤

---

## ğŸ¯ å»ºè®®æ‰§è¡Œé¡ºåº

### ç¬¬ä¸€æ­¥: éªŒè¯åˆ†æï¼ˆ1 å¤©ï¼‰
1. è¿è¡Œæ‰€æœ‰æµ‹è¯•ï¼Œç¡®ä¿å½“å‰çŠ¶æ€æ­£å¸¸
2. å†æ¬¡éªŒè¯æœªä½¿ç”¨çš„ä»£ç ï¼ˆä½¿ç”¨ grep æœç´¢ï¼‰
3. åˆ›å»ºæ¸…ç†åˆ†æ”¯

### ç¬¬äºŒæ­¥: é˜¶æ®µ 1 æ¸…ç†ï¼ˆ2-3 å¤©ï¼‰
1. åˆ é™¤ `pancake-sdk-utils.ts`
2. åˆ é™¤ `trading-channels-compat.ts` ä¸­çš„æœªä½¿ç”¨å‡½æ•°
3. æ¸…ç† `four-quote-bridge.ts` å’Œ `flap-quote-agent.ts`
4. ç§»é™¤ `background/index.ts` ä¸­çš„åˆ†æ”¯åˆ¤æ–­
5. è¿è¡Œæµ‹è¯•ï¼ŒéªŒè¯åŠŸèƒ½æ­£å¸¸

### ç¬¬ä¸‰æ­¥: é˜¶æ®µ 2 æ¸…ç†ï¼ˆ2-3 å¤©ï¼‰
1. ç»Ÿä¸€é‡è¯•æœºåˆ¶
2. ç»Ÿä¸€å®¢æˆ·ç«¯ç®¡ç†
3. åˆ é™¤æœªä½¿ç”¨çš„ç¼“å­˜ç³»ç»Ÿ
4. æ•´åˆ viem-helper
5. è¿è¡Œæµ‹è¯•ï¼ŒéªŒè¯åŠŸèƒ½æ­£å¸¸

### ç¬¬å››æ­¥: é˜¶æ®µ 3 æ¸…ç†ï¼ˆ1-2 å¤©ï¼‰
1. è¿ç§» content ä¸­çš„ç¼“å­˜æ£€æŸ¥
2. åˆ é™¤å…¼å®¹å±‚ä¸­çš„ç¼“å­˜å‡½æ•°
3. è¯„ä¼°æ˜¯å¦å®Œå…¨ç§»é™¤å…¼å®¹å±‚
4. è¿è¡Œæµ‹è¯•ï¼ŒéªŒè¯åŠŸèƒ½æ­£å¸¸

### ç¬¬äº”æ­¥: æœ€ç»ˆéªŒè¯ï¼ˆ1 å¤©ï¼‰
1. è¿è¡Œå®Œæ•´æµ‹è¯•å¥—ä»¶
2. æ‰‹åŠ¨æµ‹è¯•æ‰€æœ‰äº¤æ˜“åœºæ™¯
3. æ€§èƒ½æµ‹è¯•
4. ä»£ç å®¡æŸ¥
5. åˆå¹¶åˆ°ä¸»åˆ†æ”¯

**æ€»è®¡**: 7-10 å¤©

---

## ğŸ“ éªŒè¯æ¸…å•

### åˆ é™¤å‰éªŒè¯
- [ ] ä½¿ç”¨ `grep -r "functionName" src/` ç¡®è®¤æ— è°ƒç”¨
- [ ] æ£€æŸ¥ `background/index.ts` ä¸­çš„å¯¼å…¥
- [ ] æ£€æŸ¥ `content/index.ts` ä¸­çš„å¯¼å…¥
- [ ] æ£€æŸ¥æµ‹è¯•æ–‡ä»¶ä¸­çš„ä½¿ç”¨

### åˆ é™¤åéªŒè¯
- [ ] è¿è¡Œ `npm run build` ç¡®ä¿æ„å»ºæˆåŠŸ
- [ ] è¿è¡Œ `npm run test:run` ç¡®ä¿æµ‹è¯•é€šè¿‡
- [ ] æ‰‹åŠ¨æµ‹è¯•ä¹°å…¥/å–å‡ºåŠŸèƒ½
- [ ] æ£€æŸ¥æµè§ˆå™¨æ§åˆ¶å°æ— é”™è¯¯
- [ ] éªŒè¯æ‰€æœ‰å¹³å°äº¤æ˜“æ­£å¸¸

---

## ğŸ‰ æ€»ç»“

æœ¬æ¬¡åˆ†æå‘ç°äº† **~3200 è¡Œå¯æ¸…ç†çš„ä»£ç **ï¼Œä¸»è¦åŒ…æ‹¬ï¼š

1. **å®Œå…¨æœªä½¿ç”¨çš„æ–‡ä»¶** (100 è¡Œ)
2. **é‡å¤çš„äº¤æ˜“é€»è¾‘** (1500 è¡Œ)
3. **å·²å¼ƒç”¨çš„å…¼å®¹å±‚ä»£ç ** (600 è¡Œ)
4. **é‡å¤çš„ç¼“å­˜å’Œé‡è¯•ç³»ç»Ÿ** (800 è¡Œ)
5. **é‡å¤çš„å®¢æˆ·ç«¯ç®¡ç†** (200 è¡Œ)

æ¸…ç†åé¢„æœŸæ”¶ç›Šï¼š
- âœ… ä»£ç é‡å‡å°‘ 22%
- âœ… æ¶ˆé™¤é‡å¤é€»è¾‘
- âœ… ç»Ÿä¸€äº¤æ˜“æ¥å£
- âœ… æé«˜ä»£ç è´¨é‡
- âœ… ç®€åŒ–ç»´æŠ¤æˆæœ¬

å»ºè®®æŒ‰ç…§ 3 ä¸ªé˜¶æ®µé€æ­¥æ¸…ç†ï¼Œé¢„è®¡ 7-10 å¤©å®Œæˆã€‚

---

**æŠ¥å‘Šç”Ÿæˆæ—¶é—´**: 2026-02-11 23:00
**åˆ†æå·¥å…·**: Claude Code + äººå·¥å®¡æŸ¥
**ä¸‹ä¸€æ­¥**: å¼€å§‹é˜¶æ®µ 1 æ¸…ç†
